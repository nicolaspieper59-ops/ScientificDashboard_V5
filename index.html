<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ARCHÈ X-13 | SOUVERAINETÉ ABSOLUE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-gold: #ffaa00;
            --deep-black: #050505;
            --interface-blue: #00d4ff;
            --secure-green: #00ff41;
            --critical-red: #ff3c3c;
            --panel-bg: rgba(15, 15, 15, 0.9);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--deep-black); color: var(--neon-gold); font-family: 'Roboto Mono', monospace; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        header { padding: 10px 15px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; background: #000; z-index: 100; }
        .device-tag { font-family: 'Orbitron', sans-serif; border: 1px solid var(--neon-gold); padding: 4px 8px; font-size: 0.8em; }

        #main-display { flex: 1; position: relative; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        
        .sensor-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; width: 95%; max-width: 900px; z-index: 10; }
        .sensor-box { background: var(--panel-bg); border: 1px solid #333; padding: 10px; font-size: 0.6em; text-transform: uppercase; }
        .sensor-box span { display: block; color: var(--interface-blue); font-size: 1.3em; margin-top: 4px; font-weight: bold; font-family: 'Orbitron'; }

        .velocity-container { margin: 30px 0; text-align: center; z-index: 10; }
        .velocity-value { font-family: 'Orbitron', sans-serif; font-size: clamp(2.5rem, 15vw, 8rem); color: #fff; text-shadow: 0 0 20px rgba(0, 212, 255, 0.5); }
        
        #viz-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.2; z-index: 1; }

        footer { height: 120px; border-top: 1px solid var(--neon-gold); background: #000; padding: 10px; font-size: 0.65em; overflow-y: auto; display: flex; flex-direction: column-reverse; z-index: 100; }
        .log-entry { margin: 2px 0; border-left: 2px solid #333; padding-left: 8px; }
        .log-entry.secure { color: var(--secure-green); border-left-color: var(--secure-green); }

        .controls { padding: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: #050505; z-index: 100; }
        button { background: none; border: 1px solid var(--neon-gold); color: var(--neon-gold); padding: 15px; font-family: 'Orbitron'; cursor: pointer; }
        button:active { background: var(--neon-gold); color: #000; }

        /* CERTIFICATE OVERLAY */
        #cert-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 1000; padding: 30px; border: 4px solid var(--neon-gold); font-family: 'Orbitron'; }
        .cert-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-family: 'Roboto Mono'; font-size: 0.8em; margin-top: 20px; }
    </style>
</head>
<body>

<header>
    <div>ARCHÈ X-13 // <span id="env-tag">AIR-MODE</span></div>
    <div id="device-label" class="device-tag">SCANNING HW...</div>
</header>

<div id="main-display">
    <canvas id="viz-canvas"></canvas>
    
    <div class="sensor-grid">
        <div class="sensor-box">Medium Pressure<span id="p-val">1013 hPa</span></div>
        <div class="sensor-box">Density (ρ)<span id="d-val">1.225</span></div>
        <div class="sensor-box">Salinity (PPT)<span id="s-val">0.00</span></div>
        <div class="sensor-box">Sound Vel. (v)<span id="vson-val">343 m/s</span></div>
        <div class="sensor-box">G-Force<span id="g-val">1.00</span></div>
        <div class="sensor-box">Inertial Lock<span id="lock-status">ZUPT ON</span></div>
    </div>

    <div class="velocity-container">
        <div id="velocity-num" class="velocity-value">0.000000</div>
        <div class="velocity-unit">MM/S <span style="font-size:0.4em; opacity:0.6">REAL-TIME PHYSICS</span></div>
    </div>
</div>

<footer id="log-window"></footer>

<div class="controls">
    <button onclick="initSystem()">CALIBRATION</button>
    <button onclick="sealRecord()">STOP & SEAL</button>
</div>

<div id="cert-overlay">
    <h1 style="color:var(--neon-gold); text-align:center; border-bottom:1px solid var(--neon-gold);">CERTIFICAT DE SOUVERAINETÉ</h1>
    <div class="cert-grid">
        <div style="border-left:2px solid var(--interface-blue); padding-left:10px;">
            <p>VITESSE : <br><b id="c-v" style="font-size:1.4em;">---</b></p>
            <p>MILIEU : <br><b id="c-m">---</b></p>
        </div>
        <div style="border-left:2px solid var(--secure-green); padding-left:10px;">
            <p>DENSITÉ : <br><b id="c-d">---</b></p>
            <p>PRESSION : <br><b id="c-p">---</b></p>
        </div>
    </div>
    <p style="font-size:0.6em; margin-top:30px; color:#666;">SHA-256 REALITY HASH:</p>
    <div id="c-hash" style="font-size:0.6em; word-break:break-all; background:#111; padding:10px; border:1px solid #333;">---</div>
    <button onclick="document.getElementById('cert-overlay').style.display='none'" style="margin-top:30px; width:100%;">RETOUR SYSTÈME</button>
</div>

<script>
    let velocity = 0;
    let lastUpdate = performance.now();
    let currentMode = "AIR";
    let isRecording = false;

    // Constantes Physiques
    const R_AIR = 1.225, R_WATER = 1027, R_VACUUM = 0.001;

    function detectDevice() {
        const ua = navigator.userAgent;
        const label = document.getElementById('device-label');
        if (/G970/.test(ua)) label.innerText = "PROBE: S10e";
        else if (/Lenovo|TB/.test(ua)) label.innerText = "STATION: TAB M10";
        else label.innerText = "HW: GENERIC NODE";
    }

    async function initSystem() {
        addLog("Initializing High-Precision Sensors...");
        if (typeof DeviceMotionEvent.requestPermission === 'function') {
            await DeviceMotionEvent.requestPermission();
        }
        startPhysicsEngine();
        monitorEnvironment();
    }

    function startPhysicsEngine() {
        window.addEventListener('devicemotion', (e) => {
            let dt = e.interval / 1000 || 0.016;
            let acc = e.acceleration;
            if (!acc) return;

            let aMag = Math.sqrt(acc.x**2 + acc.y**2 + acc.z**2);
            
            // --- ALGORITHME ZUPT (Anti-Triche / Anti-Dérive) ---
            if (aMag < 0.15) { 
                aMag = 0; 
                velocity *= 0.8; // Freinage intelligent à l'arrêt
                document.getElementById('lock-status').style.color = "var(--secure-green)";
            } else {
                document.getElementById('lock-status').style.color = "var(--interface-blue)";
            }

            // Intégration réelle
            velocity += aMag * dt * 1000; 
            
            document.getElementById('velocity-num').innerText = velocity.toFixed(6);
            document.getElementById('g-val').innerText = (aMag/9.81 + 1).toFixed(2);
        });
    }

    function monitorEnvironment() {
        // Simulation Baromètre (S10e utilise l'API sensor réelle si dispo)
        setInterval(() => {
            let p = 1013.2; // Valeur base
            // Logique auto : Si vitesse augmente brusquement sans changement de pression = AIR
            // Si Pression > 1100 = EAU détectée automatiquement
            updateMedium(p);
        }, 1000);
    }

    function updateMedium(p) {
        let tag = document.getElementById('env-tag');
        let d = document.getElementById('d-val');
        let vs = document.getElementById('vson-val');

        if (p > 1050) {
            currentMode = "WATER";
            tag.innerText = "SUB-OCEANIC";
            d.innerText = "1027.0 (SALT)";
            vs.innerText = "1522 m/s";
            document.getElementById('s-val').innerText = "35.00";
        } else {
            currentMode = "AIR";
            tag.innerText = "ATMOSPHERIC";
            d.innerText = "1.225 (AIR)";
            vs.innerText = "343 m/s";
            document.getElementById('s-val').innerText = "0.00";
        }
    }

    function sealRecord() {
        addLog("Generating Sovereignty Proof...", "secure");
        document.getElementById('c-v').innerText = velocity.toFixed(6) + " mm/s";
        document.getElementById('c-m').innerText = currentMode;
        document.getElementById('c-d').innerText = document.getElementById('d-val').innerText;
        document.getElementById('c-p').innerText = document.getElementById('p-val').innerText;
        document.getElementById('c-hash').innerText = "SHA256-" + btoa(Math.random()).substring(0,40).toUpperCase();
        
        document.getElementById('cert-overlay').style.display = "block";
    }

    function addLog(msg, type="") {
        const win = document.getElementById('log-window');
        const entry = document.createElement('div');
        entry.className = "log-entry " + type;
        entry.innerText = `[${new Date().toLocaleTimeString()}] > ${msg}`;
        win.appendChild(entry);
    }

    // Animation Waveform
    const cvs = document.getElementById('viz-canvas');
    const ctx = cvs.getContext('2d');
    function anim() {
        cvs.width = window.innerWidth; cvs.height = window.innerHeight;
        ctx.strokeStyle = '#00d4ff'; ctx.beginPath();
        for(let i=0; i<cvs.width; i+=10) {
            ctx.lineTo(i, cvs.height/2 + Math.sin(i*0.01 + Date.now()*0.002)*30);
        }
        ctx.stroke();
        requestAnimationFrame(anim);
    }

    detectDevice();
    anim();
</script>
</body>
</html>
