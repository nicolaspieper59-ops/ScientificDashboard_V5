<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PROVIDENCE V140 • OMNI-SOUVERAIN ULTRA-CORE</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.158.0/three.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@300;500;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #020202; 
            --panel-bg: rgba(10, 10, 12, 0.98); 
            --border: #1a1a1f;
            --accent: #00ff88;    /* VERT: Physique */
            --blue: #00c3ff;      /* BLEU: Navigation */
            --gold: #ffd700;      /* OR: Environnement */
            --critical: #ff3300;
            --violet: #bc13fe;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }
        
        body { 
            background: var(--bg); color: #e0e0e0; 
            font-family: 'JetBrains Mono', monospace; 
            height: 100dvh; width: 100vw; overflow: hidden; 
            display: flex; flex-direction: column;
            font-size: 9px;
        }

        header { 
            height: 40px; border-bottom: 1px solid #333; 
            display: flex; align-items: center; justify-content: space-between; 
            padding: 0 12px; background: #000; z-index: 100;
        }

        main { 
            flex: 1; display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
            gap: 8px; padding: 8px; overflow-y: auto;
            background: radial-gradient(circle at 50% 50%, #08080c 0%, #000 100%);
        }

        /* --- STRUCTURE DES PANNEAUX --- */
        .panel { 
            background: var(--panel-bg); border: 1px solid var(--border);
            border-radius: 2px; display: flex; flex-direction: column;
        }

        .panel-header {
            padding: 6px 10px; background: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid var(--border); display: flex; 
            justify-content: space-between; align-items: center;
        }

        .panel-header h2 {
            font-family: 'Orbitron'; font-size: 0.6rem; letter-spacing: 1px;
            margin: 0; text-transform: uppercase;
        }

        .panel-content { padding: 8px; flex: 1; }

        /* --- GRILLE DE DONNÉES (DENSE) --- */
        .metrics-grid { 
            display: grid; grid-template-columns: 1fr 1fr; 
            gap: 4px; margin-bottom: 6px; 
        }

        .data-box { 
            background: rgba(0,0,0,0.5); border: 1px solid #1a1a1a; 
            padding: 5px 8px; display: flex; flex-direction: column;
            border-left: 2px solid #333;
        }

        .label { font-size: 0.5rem; color: #555; text-transform: uppercase; margin-bottom: 1px; }
        .value { font-size: 0.8rem; color: #fff; font-weight: 500; white-space: nowrap; overflow: hidden; }
        .unit { font-size: 0.5rem; color: #444; margin-left: 2px; }

        /* --- FOOTER --- */
        footer { 
            background: #000; border-top: 1px solid #333;
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 8px; padding: 8px;
        }

        #map { height: 130px; width: 100%; border: 1px solid #222; margin-bottom: 8px; border-radius: 2px; }
        canvas { width: 100%; background: #000; }

        progress { width: 100%; height: 3px; appearance: none; border: none; background: #111; margin-top: 2px; }
        progress::-webkit-progress-value { background: var(--accent); }

        button { 
            background: #111; color: #888; border: 1px solid #333; padding: 6px;
            font-family: 'Orbitron'; font-size: 0.55rem; cursor: pointer; transition: 0.2s;
        }
        button:hover { background: #222; color: #fff; border-color: var(--accent); }
        .btn-main { background: var(--accent); color: #000; border: none; font-weight: 800; }
        
        #anomaly-log { 
            font-size: 0.6rem; color: var(--accent); height: 80px; overflow-y: auto; 
            font-family: 'JetBrains Mono'; background: #050505; padding: 6px; border: 1px solid #111;
        }

        .tech-detail { font-size: 0.5rem; color: #3d3d3d; text-align: right; }
    </style>
</head>
<body>

<header>
    <div style="font-family:'Orbitron'; color:var(--accent); font-weight:bold;">
        PROVIDENCE <span id="ui-version">V140.0-ULTRA</span>
    </div>
    <div style="font-family:'Orbitron'; font-size:1.1rem; color:var(--blue);" id="ui-clock">00:00:00</div>
    <div style="font-size:0.55rem; color:#666;">
        SMP: <span id="ui-sampling-rate">0</span>Hz | 
        LAT: <span id="tslv" style="color:var(--accent);">0ms</span> | 
        UP: <span id="ui-uptime">00:00</span>
    </div>
</header>

<main>
    <section class="panel" style="border-top: 2px solid var(--blue);">
        <div class="panel-header">
            <h2 style="color:var(--blue);"><i class="fas fa-satellite"></i> NAVIGATION_CORE_EKF</h2>
            <span id="ui-env-mode" style="font-size:0.5rem; color:var(--blue); border:1px solid var(--blue); padding:1px 3px;">STANDBY</span>
        </div>
        <div class="panel-content">
            <div id="map"></div>
            <div class="metrics-grid">
                <div class="data-box" style="border-left-color:var(--blue);"><span class="label">Lat EKF</span><span class="value" id="lat-ekf">0.00000000</span></div>
                <div class="data-box" style="border-left-color:var(--blue);"><span class="label">Lon EKF</span><span class="value" id="lon-ekf">0.00000000</span></div>
                <div class="data-box"><span class="label">Alt EKF</span><span class="value"><span id="alt-ekf">0.00</span><span class="unit">m</span></span></div>
                <div class="data-box"><span class="label">Acc GPS</span><span class="value">±<span id="acc-gps">0.0</span><span class="unit">m</span></span></div>
                <div class="data-box"><span class="label">Heading</span><span class="value" id="heading-display">000.0°</span></div>
                <div class="data-box"><span class="label">True North</span><span class="value" id="ui-true-north">000.0°</span></div>
                <div class="data-box"><span class="label">Ground Speed</span><span class="value" id="ui-ground-speed">0.00</span></div>
                <div class="data-box"><span class="label">Declinaison</span><span class="value" id="ui-mag-declination">0.0°</span></div>
                <div class="data-box"><span class="label">Sats Count</span><span class="value" id="ui-sat-count">0</span></div>
                <div class="data-box"><span class="label">HDOP</span><span class="value" id="ui-gps-hdop">0.00</span></div>
            </div>
            <div class="metrics-grid">
                <div class="data-box" style="border-left-color:var(--gold);"><span class="label">Dist. Home</span><span class="value" id="ui-home-dist">0.00 m</span></div>
                <div class="data-box" style="border-left-color:var(--gold);"><span class="label">Bearing Home</span><span class="value" id="ui-bearing-home">000°</span></div>
                <div class="data-box"><span class="label">Schuler Loop</span><span class="value" id="ui-schuler-status">INACTIVE</span></div>
                <div class="data-box"><span class="label">IA Arbitrator</span><span class="value" id="master-source">PENDING</span></div>
            </div>
        </div>
    </section>

    <section class="panel" style="border-top: 2px solid var(--accent);">
        <div class="panel-header">
            <h2 style="color:var(--accent);"><i class="fas fa-bolt"></i> KINETIC_RESL_CORE</h2>
            <span id="ui-scale-active" style="font-size:0.5rem; color:#555;">RES: NANO</span>
        </div>
        <div class="panel-content">
            <canvas id="gforce-canvas" height="70"></canvas>
            <div class="data-box" style="margin: 6px 0; text-align: center; border: 1px solid var(--accent);">
                <span class="label">Vitesse Brute Absolute (mm/s)</span>
                <span class="value" style="font-size:1.5rem; color:var(--accent);" id="vitesse-raw">0.000000000</span>
            </div>
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Vitesse KM/H</span><span class="value" id="speed-stable-kmh">0.00</span></div>
                <div class="data-box"><span class="label">Vitesse KTS</span><span class="value" id="ui-speed-knots">0.00</span></div>
                <div class="data-box"><span class="label">Mach Num</span><span class="value" id="mach-val">0.000</span></div>
                <div class="data-box" style="border-left-color:var(--violet);"><span class="label">Lorentz γ</span><span class="value" id="ui-lorentz">1.000000</span></div>
            </div>
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Acc X</span><span class="value" id="acc-x">0.00</span></div>
                <div class="data-box"><span class="label">Acc Y</span><span class="value" id="acc-y">0.00</span></div>
                <div class="data-box"><span class="label">Acc Z</span><span class="value" id="acc-z">0.00</span></div>
                <div class="data-box"><span class="label">Jerk (m/s³)</span><span class="value" id="ui-jerk">0.00</span></div>
                <div class="data-box"><span class="label">Force G</span><span class="value" id="force-g-inst">1.00 G</span></div>
                <div class="data-box" style="border-left-color:var(--critical);"><span class="label">Impact Max</span><span class="value" id="ui-impact-g">0.00 G</span></div>
            </div>
            <h3 style="font-size:0.5rem; color:#444; margin-top:5px; text-transform:uppercase;">Biométrie / Sport</h3>
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Cadence Pas</span><span class="value" id="ui-sport-cadence">0</span></div>
                <div class="data-box"><span class="label">Saut Height</span><span class="value" id="ui-jump-height">0.0 cm</span></div>
                <div class="data-box"><span class="label">Type Mouvement</span><span class="value" id="ui-sport-type">STATIC</span></div>
                <div class="data-box"><span class="label">Calories</span><span class="value" id="ui-calories">0</span></div>
            </div>
        </div>
    </section>

    <section class="panel" style="border-top: 2px solid var(--gold);">
        <div class="panel-header">
            <h2 style="color:var(--gold);"><i class="fas fa-wind"></i> FLUID_DYNAMICS_ENV</h2>
            <span id="ui-rad-total" style="font-size:0.5rem; color:var(--critical); border:1px solid var(--critical); padding:1px 3px;">0 mSv</span>
        </div>
        <div class="panel-content">
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Température</span><span class="value"><span id="air-temp-c">0.0</span>°C</span></div>
                <div class="data-box"><span class="label">Humidité</span><span class="value"><span id="humidity-pct">0</span>%</span></div>
                <div class="data-box"><span class="label">Pression Atm</span><span class="value" id="pressure-hpa">1013</span></div>
                <div class="data-box"><span class="label">Luminosité</span><span class="value" id="ambient-light">0 lx</span></div>
                <div class="data-box" style="border-left-color:var(--violet);"><span class="label">Radiation Rate</span><span class="value" id="ui-rad-level">0.080</span></div>
                <div class="data-box" style="border-left-color:var(--violet);"><span class="label">Flux Mag (µT)</span><span class="value" id="ui-elec-flux">0.00</span></div>
                <div class="data-box"><span class="label">Watt Induced</span><span class="value" id="ui-elec-watt">0.00</span></div>
                <div class="data-box"><span class="label">Pollution PM2.5</span><span class="value" id="pm25-val">0.0</span></div>
            </div>
            <div class="data-box" style="background:rgba(255,215,0,0.03); margin-bottom:4px;">
                <span class="label">Nombre de Reynolds (Re)</span>
                <span class="value" id="reynolds-number">0</span>
                <div class="tech-detail">Régime: <span id="ui-flow-regime">LAMINAIRE</span></div>
            </div>
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Pression Dyn (q)</span><span class="value" id="dynamic-pressure">0 Pa</span></div>
                <div class="data-box"><span class="label">Densité Air (ρ)</span><span class="value" id="air-density">1.225</span></div>
                <div class="data-box"><span class="label">Vitesse Son</span><span class="value" id="ui-speed-sound">343 m/s</span></div>
                <div class="data-box"><span class="label">Point Rosée</span><span class="value" id="ui-dew-point">0.0°C</span></div>
            </div>
        </div>
    </section>
</main>

<footer>
    <div class="panel" style="border-left: 3px solid var(--violet);">
        <div class="panel-header" style="color:var(--violet);">TEMPORAL_ASTRO_SYNC</div>
        <div class="panel-content">
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Date Julienne</span><span class="value" id="ast-jd">--</span></div>
                <div class="data-box"><span class="label">MJD</span><span class="value" id="ast-mjd">--</span></div>
                <div class="data-box"><span class="label">Minecraft Time</span><span class="value" id="time-minecraft">--</span></div>
                <div class="data-box"><span class="label">Sidereal Time</span><span class="value" id="ui-sidereal">--</span></div>
                <div class="data-box"><span class="label">Phase Lunaire</span><span class="value" id="moon-phase-name">--</span></div>
                <div class="data-box" style="border-left-color:var(--violet);"><span class="label">Δ Relativiste</span><span class="value" id="total-time-dilation" style="color:var(--violet);">0 ns</span></div>
            </div>
            <div class="data-box" style="border-top:1px dashed #333; margin-top:4px;">
                <span class="label">Cosmos Distance (LY)</span>
                <span class="value" id="ui-dist-ly" style="font-size:0.65rem;">0.000000000000</span>
                <div style="display:flex; justify-content:space-between; font-size:0.45rem; color:#444;">
                    <span>Comobile: <span id="ui-dist-comobile">0</span>m</span>
                    <span>Observable: <span id="ui-observable-pct">0</span>%</span>
                </div>
            </div>
        </div>
    </div>

    <div class="panel" style="border-left: 3px solid #6600cc;">
        <div class="panel-header">ARBITRATOR_AI & CONFIDENCE</div>
        <div class="panel-content">
            <div class="label" style="display:flex; justify-content:space-between;">CONFIDENCE IMU <span id="trust-imu-val">0%</span></div>
            <progress id="trust-imu" value="100" max="100"></progress>
            <div class="label">CONFIDENCE OPTICAL</div>
            <progress id="trust-opt" value="0" max="100"></progress>
            <div class="label">CONFIDENCE AUDIO</div>
            <progress id="trust-audio" value="0" max="100"></progress>
            
            <div style="margin-top:8px; height:45px; position:relative; background:#000; border:1px solid #1a1a1a;">
                <canvas id="ar-canvas" height="40"></canvas>
                <div id="ui-path-points" style="position:absolute; bottom:2px; right:4px; font-size:0.4rem; color:#444;">0 PTS</div>
            </div>
        </div>
    </div>

    <div class="panel">
        <div class="panel-content" style="display:flex; flex-direction:column; gap:5px;">
            <div id="anomaly-log">> SYSTEM_READY_V140</div>
            <button id="main-init-btn" class="btn-main" style="height:35px;">START_OMNI_CORE_V140</button>
            <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:4px;">
                <button onclick="OMNI_CORE.setAnchor()">ZERO_REF</button>
                <button id="export-metrics-btn">CSV_EXPORT</button>
                <button id="clear-log-btn" onclick="document.getElementById('anomaly-log').innerHTML=''">CLS</button>
                <button id="emergency-stop-btn" style="color:var(--critical); grid-column: span 3;">STOP_HALT_CORE</button>
            </div>
        </div>
    </div>
</footer>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="lib/ephem.js"></script>
<script src="api/weather.js"></script>

<script src="lib/astro.js"></script>

    
<script src="gnss-dashboard-full.js"></script>
</body>
</html>
