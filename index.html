<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PROVIDENCE V140.0 • OMNI-SOUVERAIN (EXTENDED)</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.158.0/three.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@300;500;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #020202; 
            --panel-bg: rgba(16, 16, 20, 0.95); 
            --border: #222;
            --accent: #00ff88;
            --blue: #00c3ff;
            --gold: #ffd700;
            --critical: #ff3300;
            --violet: #bc13fe;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }
        body { background: var(--bg); color: #e0e0e0; font-family: 'JetBrains Mono', monospace; height: 100dvh; width: 100vw; overflow: hidden; display: flex; flex-direction: column; font-size: 10px; }
        
        header { height: 40px; border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; background: #000; }

        main { flex: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 8px; padding: 8px; overflow-y: auto; }

        .panel { background: var(--panel-bg); border: 1px solid var(--border); border-radius: 4px; display: flex; flex-direction: column; }
        .panel-header { padding: 6px 12px; background: rgba(255, 255, 255, 0.02); border-bottom: 1px solid var(--border); font-family: 'Orbitron'; font-size: 0.6rem; color: var(--blue); }
        .panel-content { padding: 10px; flex: 1; }

        /* GRILLE DE DIVS INDIVIDUELLES (Comme dans l'autre HTML) */
        .metrics-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-bottom: 8px; }
        .data-box { background: rgba(0,0,0,0.6); border: 1px solid #1a1a1a; padding: 6px 8px; display: flex; flex-direction: column; }
        
        .label { color: #555; font-size: 0.5rem; text-transform: uppercase; margin-bottom: 2px; }
        .value { color: #fff; font-size: 0.85rem; font-weight: 500; overflow: hidden; text-overflow: ellipsis; }
        .unit { color: #333; font-size: 0.5rem; margin-left: 2px; }

        footer { height: auto; background: #000; border-top: 1px solid #333; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 8px; padding: 8px; }
        
        #map { height: 120px; width: 100%; border: 1px solid #222; margin-bottom: 8px; }
        canvas { width: 100%; background: #000; border-radius: 2px; }
        
        progress { width: 100%; height: 3px; appearance: none; border: none; background: #111; margin-top: 2px; }
        progress::-webkit-progress-value { background: var(--accent); }
        
        .btn-main { background: var(--accent); color: #000; border: none; padding: 8px; font-weight: bold; cursor: pointer; font-family: 'Orbitron'; font-size: 0.6rem; }
        #anomaly-log { font-size: 0.6rem; color: #444; height: 60px; overflow-y: auto; background: #050505; padding: 5px; border: 1px solid #111; }
    </style>
</head>
<body>

<header>
    <div style="color:var(--accent); font-family:Orbitron;">PROVIDENCE V140 // SOUVERAIN</div>
    <div id="ui-clock" style="font-family:Orbitron; font-size:1.1rem; color:var(--blue);">00:00:00</div>
    <div style="font-size:0.55rem; color:#444;">LAT: <span id="tslv">0</span>ms | <span id="ui-sampling-rate">0</span>Hz</div>
</header>

<main>
    <div class="panel">
        <div class="panel-header">NAVIGATION_CORE_EKF</div>
        <div class="panel-content">
            <div id="map"></div>
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Latitude EKF</span><span class="value" id="lat-ekf">0.000000</span></div>
                <div class="data-box"><span class="label">Longitude EKF</span><span class="value" id="lon-ekf">0.000000</span></div>
                <div class="data-box"><span class="label">Alt. Ellips.</span><span class="value"><span id="alt-ekf">0.00</span><span class="unit">m</span></span></div>
                <div class="data-box"><span class="label">Précision GPS</span><span class="value">±<span id="acc-gps">0.0</span><span class="unit">m</span></span></div>
                <div class="data-box"><span class="label">Cap Magnétique</span><span class="value" id="heading-display">000°</span></div>
                <div class="data-box"><span class="label">Nord Géographique</span><span class="value" id="ui-true-north">000°</span></div>
                <div class="data-box"><span class="label">Déclinaison</span><span class="value" id="ui-mag-declination">0.0°</span></div>
                <div class="data-box"><span class="label">Satellites</span><span class="value" id="ui-sat-count">0</span></div>
                <div class="data-box"><span class="label">HDOP</span><span class="value" id="ui-gps-hdop">0.00</span></div>
                <div class="data-box"><span class="label">Ground Speed</span><span class="value" id="ui-ground-speed">0.00</span></div>
            </div>
            <div class="metrics-grid">
                <div class="data-box" style="border-left:2px solid var(--gold);"><span class="label">Dist. Home</span><span class="value" id="ui-home-dist">0.00 m</span></div>
                <div class="data-box"><span class="label">Bearing Home</span><span class="value" id="ui-bearing-home">000°</span></div>
            </div>
        </div>
    </div>

    <div class="panel" style="border-top: 2px solid var(--accent);">
        <div class="panel-header" style="color:var(--accent);">PHYSIQUE_KINETIC_RESL</div>
        <div class="panel-content">
            <canvas id="gforce-canvas" height="60"></canvas>
            <div class="data-box" style="margin: 5px 0; text-align: center; border: 1px solid var(--accent);">
                <span class="label">Vitesse Brute (Résolution Max)</span>
                <span class="value" style="font-size:1.4rem; color:var(--accent);" id="vitesse-raw">0.000000000</span>
            </div>
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Stable KM/H</span><span class="value" id="speed-stable-kmh">0.00</span></div>
                <div class="data-box"><span class="label">Nautique KTS</span><span class="value" id="ui-speed-knots">0.00</span></div>
                <div class="data-box"><span class="label">Mach Number</span><span class="value" id="mach-val">0.000</span></div>
                <div class="data-box"><span class="label">Facteur Lorentz</span><span class="value" id="ui-lorentz">1.0000</span></div>
                <div class="data-box"><span class="label">Acc. X</span><span class="value" id="acc-x">0.00</span></div>
                <div class="data-box"><span class="label">Acc. Y</span><span class="value" id="acc-y">0.00</span></div>
                <div class="data-box"><span class="label">Acc. Z</span><span class="value" id="acc-z">0.00</span></div>
                <div class="data-box"><span class="label">Jerk (m/s³)</span><span class="value" id="ui-jerk">0.00</span></div>
                <div class="data-box"><span class="label">G-Force Inst.</span><span class="value" id="force-g-inst">1.00 G</span></div>
                <div class="data-box" style="color:var(--critical);"><span class="label">Impact Max</span><span class="value" id="ui-impact-g">0.00 G</span></div>
            </div>
        </div>
    </div>

    <div class="panel" style="border-top: 2px solid var(--gold);">
        <div class="panel-header" style="color:var(--gold);">ENVIRONMENT_REYNOLDS</div>
        <div class="panel-content">
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Température</span><span class="value"><span id="air-temp-c">0.0</span>°C</span></div>
                <div class="data-box"><span class="label">Humidité</span><span class="value"><span id="humidity-pct">0</span>%</span></div>
                <div class="data-box"><span class="label">Pression Atm.</span><span class="value" id="pressure-hpa">0</span></div>
                <div class="data-box"><span class="label">Luminosité</span><span class="value" id="ambient-light">0 lx</span></div>
                <div class="data-box"><span class="label">Flux Mag.</span><span class="value" id="ui-elec-flux">0.00 µT</span></div>
                <div class="data-box"><span class="label">Induction Watt</span><span class="value" id="ui-elec-watt">0.00</span></div>
                <div class="data-box"><span class="label">Radiation Rate</span><span class="value" id="ui-rad-level">0.08 µSv/h</span></div>
                <div class="data-box" style="color:var(--critical);"><span class="label">Dose Totale</span><span class="value" id="ui-rad-total">0 mSv</span></div>
            </div>
            <div class="data-box" style="background:rgba(255,215,0,0.05);">
                <span class="label">Nombre de Reynolds (Re)</span>
                <span class="value" id="reynolds-number">0</span>
                <span class="label" style="margin-top:4px;">Pression Dynamique (q)</span>
                <span class="value" id="dynamic-pressure">0.00 Pa</span>
            </div>
            <div class="metrics-grid" style="margin-top:4px;">
                <div class="data-box"><span class="label">Densité Air</span><span class="value" id="air-density">1.225</span></div>
                <div class="data-box"><span class="label">Vitesse Son</span><span class="value" id="ui-speed-sound">343 m/s</span></div>
            </div>
        </div>
    </div>
</main>

<footer>
    <div class="panel">
        <div class="panel-content">
            <div class="metrics-grid">
                <div class="data-box"><span class="label">Julian Date</span><span class="value" id="ast-jd">--</span></div>
                <div class="data-box"><span class="label">Sidereal Time</span><span class="value" id="ui-sidereal">--</span></div>
                <div class="data-box"><span class="label">Dist. LY</span><span class="value" id="ui-dist-ly" style="font-size:0.6rem;">0.000...</span></div>
                <div class="data-box"><span class="label">Δ Relativiste</span><span class="value" id="total-time-dilation" style="color:var(--violet);">0 ns</span></div>
            </div>
        </div>
    </div>

    <div class="panel">
        <div class="panel-content">
            <div class="label">Arbitrator AI Confidence</div>
            <progress id="trust-imu" value="100" max="100"></progress>
            <progress id="trust-opt" value="0" max="100"></progress>
            <progress id="trust-audio" value="0" max="100"></progress>
            <div class="data-box" style="margin-top:5px;">
                <span class="label">Master Source</span>
                <span class="value" id="master-source" style="color:var(--accent);">IMU_PRIMARY</span>
            </div>
            <canvas id="ar-canvas" height="30"></canvas>
        </div>
    </div>

    <div class="panel">
        <div id="anomaly-log">> CORE_STANDBY</div>
        <button id="main-init-btn" class="btn-main">BOOT_V140_SOUVERAIN</button>
        <div class="metrics-grid" style="margin-top:4px;">
            <button onclick="OMNI_CORE.setAnchor()">ZERO</button>
            <button id="export-metrics-btn">CSV</button>
            <button id="emergency-stop-btn" style="color:var(--critical);">HALT</button>
            <div class="data-box"><span class="label">Uptime</span><span class="value" id="ui-uptime">00:00</span></div>
        </div>
    </div>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="lib/ephem.js"></script>
<script src="api/weather.js"></script>

<script src="lib/astro.js"></script>

    
<script src="gnss-dashboard-full.js"></script>
</body>
</html>
